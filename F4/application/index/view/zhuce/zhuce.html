<!DOCTYPE html>
<html>

	<head>
		<meta name="renderer" content="webkit|ie-comp|ie-stand">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta charset='utf-8'>
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<title>注册</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta http-equiv="Cache-Control" content="no-siteapp">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="format-detection" content="telephone=no">
		<meta name="keywords" content="">
		<meta name="description" content="">
		<link rel="stylesheet" type="text/css" href="__STATIC__/index/css/page.css" />
		<link rel="stylesheet" type="text/css" href="__STATIC__/index/css/base.css" />
		<script src="__STATIC__/index/js/jquery-1.8.3.min.js" type="text/javascript"></script>
		<script type="text/javascript" src="__STATIC__/index/js/jquery.SuperSlide.2.1.js"></script>
  		<script src="__STATIC__/layui/layui.js"></script>
  

			<style>
				.sex{
					display: inline-block;
					font-size: 15px;
					color: #666;
					width: 64px;
					text-align: center;
				}
				.xb{
					/*border: 1px solid red;*/
					margin-top: 15px;
				}
				.xb label{
					display: inline;
					width: 0px;
					padding: 10px;
					cursor: pointer;
				}
				.tx{
	                background-color: #F2F2F2;
	                border: 0;
	                font-size: 微软雅黑;
	                color: #393D49;
	                width: 300px;
	                height: 50px;
	                border: 1px solid #F92672;
	                border-radius: 4px;
	                line-height: 50px;
	                text-align: center;
	            }
			</style>
	</head>
	<body class="sign-bg">
	<form action="" method="post" name="myform" onsubmit="return doregister()">
		<div class="sign clearfix">
			<div class="top clearfix">
				<a href="/home" class="fl fanhui">返回首页</a>
				<p class="fr">
					已有商城账号？
					<a href="/denglu" class="zhuce ra3">
						登录
					</a>
				</p>
			</div>
			<div class="bottom clearfix box-s ra10">
				<div class="sign-logo clearfix">
					<img src="__STATIC__/index/img/yuanlogo.png"/>
				</div>
				<div class="content clearfix">
					<ul>
						<li>
							<label for="L_name" class="layui-form-label">
			                    <span class="fl" style="background: url(__STATIC__/index/img/name.png) center no-repeat;background-size: 25px 25px;"></span>
			                </label>
							<input required="" type="text" name="username" pattern="^[\w]{6,12}$" id="username2" value="" placeholder="请输入用户名(6-12位数字字母下划线)" class="fl shuru" value="" />
						</li>
						<li>
							<label for="L_sex" class="layui-form-label">
			                	<span class="fl" style="background: url(__STATIC__/index/img/sex.png) center no-repeat;background-size: 25px 25px;"></span>
			                </label>
							<div class="xb">
								<font class="sex">性别</font>
								<label>男 <input required="" type="radio" name="sex" id="L_sex" lay-verify="sex" autocomplete="off" value="m" checked  title="男" class="" /></label>
								<label>女 <input required="" type="radio" name="sex" id="L_sex"  lay-verify="sex" autocomplete="off" value="w" title="女" class="" /></label>
							</div>
						</li>
						<li>
							<span class="fl" style="background: url(__STATIC__/index/img/username.png) center no-repeat;background-size: 25px 25px;"></span>
							<input required="" type="text" name="name" id="" pattern="^[\u4e00-\u9fa5a-zA-Z]+$" value="" placeholder="请输入真实姓名(汉字或英文)" class="fl shuru" />
						</li>
						<li>
							<span class="fl" style="background: url(__STATIC__/index/img/email.png) center no-repeat;background-size: 25px 25px;"></span>
							<input required="" type="email" name="email" id="" value="" pattern="^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$" placeholder="请输入邮箱地址" class="fl shuru" />
						</li>
						<li>
							<span class="fl"></span>
							<input required="" type="tel" name="phone"  id="phone" pattern="^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$" id="" value="" placeholder="请输入手机号码" class="fl shuru" />
						</li>

						<!-- 手机短信验证 -->
						<li class="yanzhengma">
							<span class="fl hudun"></span>
							<input required="" type="text" name="telcode" id="telcode" value="" placeholder="请输入验证码" class="fl shuru yzma" />
							<samp class="fr" onclick="telcode()" id="teltime" style="background-color: #BF4646;">点击获取验证码</samp>
						</li>

						<li class="yanzhengma">
							<span class="fl hudun"></span>
							<input required="" type="text" name="yzm" id="yzm" value="" placeholder="请输入验证码" class="fl shuru yzma" />
							<samp class="fr"><img width="168" HEIGHT="51" src="__STATIC__/code.php" alt="" onclick="this.src='__STATIC__/code.php?i='+Math.random();"></samp>
						</li>
						<li>
							<span class="fl mima"></span>
							<input required="" type="password" name="password" id="" value="" pattern="^\w+$" placeholder="请输入密码(6到16位)" class="fl shuru" />
						</li>
						<li>
							<span class="fl mima"></span>
							<input required="" type="password" name="repassword" id="" value="" pattern="^\w+$" placeholder="请再次输入密码" class="fl shuru" />
						</li>
						<li class="jizhu">
							<div class="radiothree fl"> 
							    <label>
							        <input required="" type="checkbox" name="" value="">
							        <div class="option"></div>
							        <p class="opt-text fl ml20">我已阅读并同意<a href="{:url('zhuce/zcxy')}">《椿龄艺术用户注册协议》</a></p>
							</div>
						</li>
					</ul>
					<input  type="submit" class="sign-btn zhuce-btn ra5" value="立即注册">

				</div>				
			</div>
			<div class="xia clearfix">
				<p>Copyright © 2003-2015 椿龄文化(chunlingwenhua). All Rights Reserved.</p>
			</div>

		</div>
	</form>
	
	<script>
		layui.use(['element','layer','form'], function(){
	        form = layui.form();
	    	lement = layui.element();//面包导航
	    	layer = layui.layer;//弹出层
	        //以上模块根据需要引入
	    });

		
		//此AJAX不用未删
		$("#username").blur(function(){
			var userv=$('#username').val();
			if (userv.replace(/\s/g,'')==''){ 
				// alert('不能为空'); 
				layer.msg('账号不能为空!',{icon: 5,time:2000});
			}else{
				reg=/^[a-zA-Z0-9_]+$/; 
				if (!reg.test(userv)) {
					alert("账号含有违法字符");
				}else{
					$.ajax({
						url:"register",
						type:"post",
						data:{info:$('#username').val()},
						dataType:"html",
						async:true,
						success:function(data){
							if(data==2){
								alert("账号不能为空");
							}else if(data==3){
								alert("账号已被注册");
							}else if(data==4){
								alert("账号长度不对");
							}else if(data==1){
								alert("账号可用");
							}
						},
						error:function(){
							alert("ajax提交失败");
						}
					});
				}
			
			}
			
		});


			// $("smap").click(function(){
				
			// })
			
			// $("#telcode").blur(function(){
			// 	var form=$("form[name='myform']");
			// 	$.ajax({
			// 		url:'{:url("Zhuce/yanzheng")}',
			// 		type:"post",
			// 		data:form.serialize(),
			// 		dataType:"html",
			// 		async:true,
			// 		success:function(data){
			// 			if(data>0){
			// 				alert("验证码不正确");
			// 			}
			// 		},
			// 		error:function(){

			// 		}
			// 	});
			// });
		
		var countdown=60;
		function daoji(){

			countdown--
			if (countdown<0) {
				
				countdown=60;
				clearInterval(dingshi);
				$("#teltime").css({background:"#BF4646"});
				$("#teltime").html('点击获取验证码');
				$("#teltime").attr("onclick","telcode()");
				return ;
			}
			$("#teltime").css({background:"#666"});
			$("#teltime").html("重新发送(" + countdown + ")");
			$("#teltime").removeAttr("onclick");
			
		}

		function telcode(){
			   
			var phone=$("#phone").val();

			if (phone.length==11 && /^1[3|4|5|7|8][0-9]\d{4,8}$/.test(phone)) { 
					$.post("{:url('zhuce/telcode')}",{phone:phone},function(data){
				        layer.alert("验证码已发送",{icon: 6});
				        dingshi=setInterval(daoji,1000);
				    });
		    }else{
		    	layer.alert("请输入有效的手机号码！",{icon: 5});
		    	
		    }

		   
		}


		function doregister(){
			$.ajax({
				url:'doregister',
				type:'post',
				data:$(myform).serialize(),
				dataType:'html',
				async:true,
				success:function(data){
					if (data>0) {
						layer.msg('注册成功',{icon: 6,time:8000});
						window.location.href="denglu";
					}else{
						layer.msg(data,{icon: 5,time:2000});
						
					}
				},
				error:function(){
					layer.alert('ajax提交失败');
				}
			})

			return false;
		}
	</script>
	</body>
</html>
